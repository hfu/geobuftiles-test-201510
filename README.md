# geobuftiles-test-201510
国土地理院ベクトルタイル提供実験の expermental_fgd (as of 2015-10-28) を tile to tile で GeoJSON から [geobuf](https://github.com/mapbox/geobuf) に変換してみる実験。

geobuf tiles というコンセプトはあり得るか確認するのが目的。

## 実施内容
- Node 版 json2geobuf を使って、デスクトップで変換を行い、圧縮率を確認する。
- geobuf データをブラウザで読み込んでみて、速度性能を確認する。

## 結果概要
### 圧縮率について
圧縮率については、タイル単位で概ね 29% から 49% の範囲内、全体では 35% 程度となった。汎用の MessagePack を使うのと比べて、圧縮率が半分以下ととなっており、圧縮率については非常に優秀である。

### 展開速度について
実験時点のデータ（つくば・新潟のデータ）全数の1/7（yのmod 7が0）について展開を行い、それに要した時間を計測した（benchmark.html）ところ、ブラウザごとに次のような結果が得られた。

### FirefoxDeveloperEdition 43.0a2 (2015-10-29)
- GeoJSON 66ms
- geobuf 65ms (98%)
Firefox の場合、展開速度はほとんど変わらないようであることがわかった。

### Chrome 46.0.2490.80 (64-bit)
- GeoJSON 61ms
- geobuf 37ms (61%)
Chrome の場合、展開に要する時間は60%程度に圧縮できる可能性があることが分かった。

### Safari 9.0.1 (11601.2.7.2)
- GeoJSON 24ms
- geobuf 24ms (100%)
Safari の場合、天界速度は変わらないことが分かった。

## 気になっていること
圧縮率は高いし、展開速度は少なくとも遅くなることはないことが分かったが、エンコーディングに要する時間がかなり多いように感じる。エンコードにかかるコストを支払いきれるかどうかを検討する必要がある。

geobufを唯一の提供フォーマットと考えるのであれば、良いところばかりであるが、GeoJSONに加えてgeobufを提供するものと考えると、必要なストレージが35%程度増加した上に、性能上の向上が限定的である、という意味になる。今回の結果をどのように捉えるべきか、悩ましい。
